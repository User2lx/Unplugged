<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Arcade Side Scrolling Car Game</title>
<style>
  body { margin:0; overflow:hidden; background:skyblue; font-family:sans-serif; }
  canvas { display:block; background:linear-gradient(#87CEEB,#ffffff 80%); }
  #ui { position:absolute; top:10px; left:10px; color:black; font-weight:bold; }
  #restartBtn { position:absolute; top:50%; left:50%; transform:translate(-50%,-50%);
                font-size:24px; padding:10px 20px; display:none; cursor:pointer; }
  #skinSelect { position:absolute; top:40px; left:10px; }
</style>
</head>
<body>
<div id="ui">
  <div id="score">Score: 0</div>
  <label for="skinSelect">Car Skin:</label>
  <select id="skinSelect">
    <option value="red">Red</option>
    <option value="blue">Blue</option>
    <option value="green">Green</option>
  </select>
</div>
<button id="restartBtn">Restart Game</button>
<canvas id="gameCanvas"></canvas>

<audio id="bgMusic" loop src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_15e173b7b4.mp3?filename=happy-background-music-loop-11329.mp3"></audio>
<audio id="jumpSound" src="https://www.soundjay.com/button/beep-07.wav"></audio>
<audio id="coinSound" src="https://www.soundjay.com/misc/sounds/coin-1.mp3"></audio>

<script>
const canvas=document.getElementById('gameCanvas');
const ctx=canvas.getContext('2d');
canvas.width=800; canvas.height=400;

let score=0, gameOver=false, speed=4, frameCount=0, obstacles=[], coins=[];

// Parallax background
const background={clouds:[], hills:[]};
for(let i=0;i<5;i++){
  background.clouds.push({x:Math.random()*canvas.width, y:Math.random()*100+20, width:80, height:50});
  background.hills.push({x:i*200, y:300, width:200, height:100});
}

// Sounds
const bgMusic=document.getElementById('bgMusic');
const jumpSound=document.getElementById('jumpSound');
const coinSound=document.getElementById('coinSound');
bgMusic.volume=0.2;
bgMusic.play();

// Car
const car={
  x:100, y:300, width:50, height:30, dy:0, gravity:0.6, jumpForce:-12,
  onGround:true, color:'red', wheelAngle:0,
  draw(){
    ctx.fillStyle=this.color;
    ctx.fillRect(this.x,this.y,this.width,this.height);
    // Animated wheels
    this.wheelAngle+=0.3;
    ctx.fillStyle='black';
    [10,40].forEach(offsetX=>{
      ctx.beginPath();
      ctx.arc(this.x+offsetX,this.y+this.height,7,0,Math.PI*2);
      ctx.fill();
      // small rotation mark
      ctx.strokeStyle='gray';
      ctx.beginPath();
      ctx.moveTo(this.x+offsetX,this.y+this.height);
      ctx.lineTo(this.x+offsetX+7*Math.cos(this.wheelAngle), this.y+this.height+7*Math.sin(this.wheelAngle));
      ctx.stroke();
    });
  }
};

// Controls
document.addEventListener('keydown', e=>{
  if(e.code==='Space' && car.onGround && !gameOver){
    car.dy=car.jumpForce; car.onGround=false; jumpSound.play();
  }
});
document.getElementById('skinSelect').addEventListener('change', e=>{car.color=e.target.value;});
document.getElementById('restartBtn').addEventListener('click',()=>{resetGame();});

function gameLoop(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // Parallax clouds
  ctx.fillStyle='white';
  background.clouds.forEach(c=>{
    c.x-=speed/2; if(c.x+c.width<0) c.x=canvas.width;
    ctx.fillRect(c.x,c.y,c.width,c.height);
  });

  // Hills
  ctx.fillStyle='green';
  background.hills.forEach(h=>{
    h.x-=speed/3; if(h.x+h.width<0) h.x=canvas.width;
    ctx.fillRect(h.x,h.y,h.width,h.height);
  });

  // Ground
  ctx.fillStyle='darkgreen';
  ctx.fillRect(0,350,canvas.width,50);

  if(!gameOver){
    // Car physics
    car.dy+=car.gravity; car.y+=car.dy;
    if(car.y+car.height>=350){ car.y=350-car.height; car.dy=0; car.onGround=true; }

    car.draw();

    // Generate obstacles
    if(frameCount%120===0){
      let type=Math.random();
      if(type<0.4) obstacles.push({x:canvas.width,y:320,width:30,height:30,color:'black',type:'block'});
      else if(type<0.7) obstacles.push({x:canvas.width,y:330,width:30,height:20,color:'gray',type:'spike'});
      else obstacles.push({x:canvas.width,y:300,width:60,height:20,color:'brown',type:'ramp',dir:Math.random()<0.5?'up':'down'});
    }

    // Generate coins
    if(frameCount%200===0) coins.push({x:canvas.width,y:270+Math.random()*50,radius:10,angle:0});

    // Move & draw obstacles
    for(let i=obstacles.length-1;i>=0;i--){
      const obs=obstacles[i];
      obs.x-=speed;
      if(obs.type==='block') ctx.fillRect(obs.x,obs.y,obs.width,obs.height);
      else if(obs.type==='spike'){
        ctx.fillStyle=obs.color;
        ctx.beginPath(); ctx.moveTo(obs.x,obs.y+obs.height);
        ctx.lineTo(obs.x+obs.width/2,obs.y);
        ctx.lineTo(obs.x+obs.width,obs.y+obs.height); ctx.closePath(); ctx.fill();
      }
      else if(obs.type==='ramp'){
        ctx.fillStyle=obs.color; ctx.beginPath();
        if(obs.dir==='up'){
          ctx.moveTo(obs.x,obs.y+obs.height); ctx.lineTo(obs.x+obs.width,obs.y); ctx.lineTo(obs.x+obs.width,obs.y+obs.height);
        }else{
          ctx.moveTo(obs.x,obs.y); ctx.lineTo(obs.x+obs.width,obs.y+obs.height); ctx.lineTo(obs.x,obs.y+obs.height);
        }
        ctx.closePath(); ctx.fill();
      }

      // Collision
      if(car.x<obs.x+obs.width && car.x+car.width>obs.x && car.y<obs.y+obs.height && car.y+car.height>obs.y){ endGame(); }
      if(obs.x+obs.width<0) obstacles.splice(i,1);
    }

    // Move & draw coins
    for(let i=coins.length-1;i>=0;i--){
      const coin=coins[i]; coin.x-=speed; coin.angle+=0.2;
      ctx.fillStyle='gold';
      ctx.beginPath();
      ctx.arc(coin.x,coin.y,coin.radius,coin.angle,coin.angle+Math.PI*1.8);
      ctx.fill();

      // Collision
      if(car.x<coin.x+coin.radius && car.x+car.width>coin.x-coin.radius && car.y<coin.y+coin.radius && car.y+car.height>coin.y-coin.radius){
        score+=50; coinSound.play(); coins.splice(i,1);
      }
      if(coin.x+coin.radius<0) coins.splice(i,1);
    }

    score++;
    document.getElementById('score').textContent='Score: '+score;
    if(frameCount%600===0) speed+=0.5;
    frameCount++; requestAnimationFrame(gameLoop);
  }
}

function endGame(){ gameOver=true; bgMusic.pause(); document.getElementById('restartBtn').style.display='block'; }

function resetGame(){
  obstacles=[]; coins=[]; score=0; speed=4; frameCount=0; gameOver=false;
  car.y=300; car.dy=0; car.onGround=true;
  bgMusic.currentTime=0; bgMusic.play();
  document.getElementById('restartBtn').style.display='none';
  gameLoop();
}

gameLoop();
</script>
</body>
</html>
